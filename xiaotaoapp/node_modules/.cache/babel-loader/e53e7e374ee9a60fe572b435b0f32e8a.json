{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _nextMoment = require('../../../next-moment/lib/index.js');\n\nvar _nextMoment2 = _interopRequireDefault(_nextMoment);\n\nvar _validators = require('../utils/validators.js');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nvar CalendarProps = {\n  propTypes: {\n    prefix: _propTypes2['default'].string,\n    base: _propTypes2['default'].any,\n    value: _propTypes2['default'].any,\n    mode: _propTypes2['default'].oneOf(['month', 'year', 'decade']),\n    dateCellRender: _propTypes2['default'].func,\n    monthCellRender: _propTypes2['default'].func,\n    yearCellRender: _propTypes2['default'].func,\n    disabledDate: _propTypes2['default'].func,\n    disabledMonth: _propTypes2['default'].func,\n    disabledYear: _propTypes2['default'].func,\n    language: _propTypes2['default'].oneOf(['en-us', 'ar', 'de', 'es', 'fr', 'hi', 'it', 'ja', 'ko', 'pt', 'ru', 'zh-cn', 'zh-hk', 'zh-tw']),\n    locale: _propTypes2['default'].object\n  },\n  defaultProps: {\n    prefix: 'next-'\n  }\n};\nvar CalendarMixin = {\n  isAllowedDate: function isAllowedDate(value) {\n    var disabledDate = this.props.disabledDate;\n\n    if (disabledDate && typeof disabledDate === 'function' && disabledDate(value)) {\n      return false;\n    }\n\n    return true;\n  },\n  isAllowedMonth: function isAllowedMonth(value) {\n    var disabledMonth = this.props.disabledMonth;\n\n    if (disabledMonth && typeof disabledMonth === 'function' && disabledMonth(value)) {\n      return false;\n    }\n\n    return true;\n  },\n  isAllowedYear: function isAllowedYear(value) {\n    var disabledYear = this.props.disabledYear;\n\n    if (disabledYear && typeof disabledYear === 'function' && disabledYear(value)) {\n      return false;\n    }\n\n    return true;\n  },\n  isSameDay: function isSameDay(one, two) {\n    if (!one || !two) {\n      return false;\n    }\n\n    one = (0, _nextMoment2['default'])(one).format('YYYY-MM-DD');\n    two = (0, _nextMoment2['default'])(two).format('YYYY-MM-DD');\n    return (0, _nextMoment2['default'])(one).isSame(two);\n  },\n  isRangeDay: function isRangeDay(day, range) {\n    if (!day || !range[0] || !range[1]) {\n      return false;\n    }\n\n    var theDay = (0, _nextMoment2['default'])(day).format('YYYY-MM-DD'),\n        rangeOne = (0, _nextMoment2['default'])(range[0]).format('YYYY-MM-DD'),\n        rangeTwo = (0, _nextMoment2['default'])(range[1]).format('YYYY-MM-DD');\n    return (0, _nextMoment2['default'])(theDay).isBetween(rangeOne, rangeTwo);\n  },\n  getMonthsLocale: function getMonthsLocale(language) {\n    // 设置多语言\n    _nextMoment2['default'].locale(language);\n\n    var localeData = _nextMoment2['default'].localeData(),\n        monthsLocale = void 0; // 获得多语言月份\n\n\n    try {\n      monthsLocale = localeData.monthsShort();\n    } catch (e) {\n      monthsLocale = localeData.months();\n    }\n\n    return monthsLocale instanceof Array ? monthsLocale : monthsLocale.format;\n  },\n  getDecadeYears: function getDecadeYears(baseYear) {\n    var base = Math.floor(baseYear / 10),\n        years = [];\n\n    for (var i = 0; i < 10; i++) {\n      years.push(base * 10 + i);\n    }\n\n    return years;\n  },\n  getLateastYears: function getLateastYears(baseYear) {\n    var years = [];\n\n    for (var i = 0; i < 21; i++) {\n      years.push(baseYear - 10 + i);\n    }\n\n    return years;\n  },\n  getCalendar: function getCalendar(base, language, locale) {\n    // 设置多语言\n    _nextMoment2['default'].locale(language);\n\n    var localeData = _nextMoment2['default'].localeData();\n\n    var firstDayOfWeek = localeData.firstDayOfWeek();\n\n    var _ref = locale.format || {},\n        customFirstDayOfWeek = _ref.firstDayOfWeek;\n\n    if ((0, _validators.isWeekdayIndex)(customFirstDayOfWeek)) {\n      firstDayOfWeek = customFirstDayOfWeek;\n    }\n\n    var calendarStartWeek = [7, 1, 2, 3, 4, 5, 6][firstDayOfWeek]; // firstDayOfWeek 0为周日\n    // 基准日期\n\n    var baseDay = (0, _nextMoment2['default'])(base) || (0, _nextMoment2['default'])(),\n        baseDayYear = baseDay.year(),\n        baseDayMonth = baseDay.month(),\n        baseMonthDays = baseDay.daysInMonth(); // 第一天\n\n    var firstDayWeek = baseDay.startOf('month').isoWeekday(); // 最后一天\n\n    var lastDayWeek = baseDay.endOf('month').isoWeekday(); // 上个月\n\n    var prevMonth = baseDayMonth - 1 < 0 ? 11 : baseDayMonth - 1;\n    var prevMonthDays = baseDay.month(prevMonth).daysInMonth();\n    var prevYear = prevMonth === 11 ? baseDayYear - 1 : baseDayYear;\n    var calendarPrevMonthDays = (firstDayWeek - calendarStartWeek + 14) % 7; //上月calendar剩余天数\n    // 下个月\n\n    var nextMonth = baseDayMonth + 1 > 11 ? 0 : baseDayMonth + 1;\n    var nextYear = nextMonth === 0 ? baseDayYear + 1 : baseDayYear;\n    var calendarNextMonthDays = (calendarStartWeek - lastDayWeek + 13) % 7; //下月calendar剩余天数\n    // 日历\n\n    var totalDays = baseMonthDays + calendarPrevMonthDays + calendarNextMonthDays,\n        counter = totalDays,\n        calendarWeek = [],\n        calendar = []; // 根据基准日期获得日历\n\n    var _loop = function _loop(i) {\n      var date = void 0,\n          year = void 0,\n          month = void 0,\n          prevDay = void 0,\n          curDay = void 0,\n          nextDay = void 0;\n      prevDay = prevMonthDays - calendarPrevMonthDays + i;\n      prevDay = prevDay > prevMonthDays ? 0 : prevDay;\n      curDay = i - calendarPrevMonthDays;\n      curDay = curDay > baseMonthDays ? 0 : curDay;\n      nextDay = i - totalDays + calendarNextMonthDays;\n      date = prevDay || curDay || nextDay;\n\n      if (prevDay) {\n        month = prevMonth;\n        year = prevYear;\n      } else if (curDay) {\n        month = baseDayMonth;\n        year = baseDayYear;\n      } else if (nextDay) {\n        month = nextMonth;\n        year = nextYear;\n      } // CalendarDate 类型\n\n\n      calendarWeek.push({\n        value: {\n          timestamp: (0, _nextMoment2['default'])().year(year).month(month).date(date).valueOf(),\n          year: year,\n          month: month,\n          // 0~11\n          date: date,\n          // 1~31\n          week: (calendarStartWeek + i - 1) % 7 === 0 ? 7 : (calendarStartWeek + i - 1) % 7,\n          // 1 ~ 7\n          valueOf: function valueOf() {\n            return (0, _nextMoment2['default'])().year(year).month(month).date(date).valueOf();\n          }\n        },\n        base: {\n          timestamp: baseDay.valueOf(),\n          year: baseDay.year(),\n          month: baseDayMonth,\n          // 0~11\n          date: baseDay.date(),\n          // 1~31\n          week: baseDay.isoWeekday(),\n          // 1~7\n          valueOf: function valueOf() {\n            return baseDay.valueOf();\n          }\n        }\n      });\n\n      if (calendarWeek.length === 7) {\n        calendar.push(calendarWeek);\n        calendarWeek = [];\n      }\n    };\n\n    for (var i = 1; i <= counter; i++) {\n      _loop(i);\n    }\n\n    return calendar;\n  }\n};\n\nfunction extend(a, b) {\n  for (var key in b) {\n    if (b.hasOwnProperty(key)) {\n      a[key] = b[key];\n    }\n  }\n}\n\nfunction CalendarMixinTo(Component) {\n  ['defaultProps', 'propTypes'].forEach(function (prop) {\n    Component[prop] = Component[prop] || {};\n    extend(Component[prop], CalendarProps[prop]);\n  });\n  extend(Component.prototype, CalendarMixin);\n}\n\nexports['default'] = CalendarMixinTo;\nmodule.exports = exports['default'];","map":null,"metadata":{},"sourceType":"script"}