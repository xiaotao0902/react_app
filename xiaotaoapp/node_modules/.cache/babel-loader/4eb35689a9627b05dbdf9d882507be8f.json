{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports['default'] = undefined;\n\nvar _class, _temp;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _nextMenu = require('../../../next-menu/lib/index.js');\n\nvar _nextMenu2 = _interopRequireDefault(_nextMenu);\n\nvar _navigation = require('./navigation.js');\n\nvar _navigation2 = _interopRequireDefault(_navigation);\n\nvar _item = require('../item/index.js');\n\nvar _item2 = _interopRequireDefault(_item);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass);\n}\n\nvar Vertical = (_temp = _class = function (_Navigation) {\n  _inherits(Vertical, _Navigation);\n\n  function Vertical(props, context) {\n    _classCallCheck(this, Vertical);\n\n    var _this = _possibleConstructorReturn(this, _Navigation.call(this, props, context));\n\n    var prefix = context.prefix;\n    prefix = (prefix || props.prefix) + 'navigation';\n    _this.childrenShowClassName = prefix + '-children-show';\n    _this.onMenuBlur = _this.onMenuBlur.bind(_this);\n    _this.state.focusedKey = null;\n    return _this;\n  }\n\n  Vertical.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    var state = {};\n\n    _Navigation.prototype.componentWillReceiveProps.call(this, nextProps);\n\n    if (nextProps.focusedKey) {\n      state.focusedKey = nextProps.focusedKey;\n    }\n\n    this.setState(state);\n  };\n  /**\n   * 注册失去焦点，收起菜单操作\n   * @method componentDidMount\n   */\n\n\n  Vertical.prototype.componentDidMount = function componentDidMount() {\n    _Navigation.prototype.componentDidMount.call(this);\n\n    var dispear = this.context.isBlurDispear || this.props.isBlurDispear;\n    dispear = this.props.blurHide === undefined ? dispear : this.props.blurHide;\n\n    if (dispear) {\n      document.body.addEventListener('click', this.onMenuBlur, false);\n    }\n  };\n  /**\n   * 移除失去焦点，收起菜单操作\n   * @method componentWillUnMount\n   */\n\n\n  Vertical.prototype.componentWillUnmount = function componentWillUnmount() {\n    var dispear = this.context.isBlurDispear || this.props.isBlurDispear;\n\n    if (dispear) {\n      document.body.removeEventListener('click', this.onMenuBlur, false);\n    }\n  };\n  /**\n   * 在导航外触发click，收起菜单处理函数\n   * @method onMenuBlur\n   */\n\n\n  Vertical.prototype.onMenuBlur = function onMenuBlur(e) {\n    var dispear = this.context.isBlurDispear || this.props.isBlurDispear,\n        refs = this.refs;\n\n    if (dispear && refs.navigation) {\n      if (!this.inNavigation(e.target)) {\n        if (this.state.focusedKey) {\n          this.setState({\n            focusedKey: null\n          });\n        }\n      }\n    }\n  };\n  /**\n   * 由item子组件mouseLeave触发处理函数;该函数处理focusedKey状态;如果trigger为hover才会处理\n   * @method onMenuBlur\n   */\n\n\n  Vertical.prototype.onItemMouseEnter = function onItemMouseEnter(itemid) {\n    var trigger = this.context.trigger;\n    trigger = trigger || this.props.trigger;\n\n    if (trigger === 'hover') {\n      if (itemid === this.state.focusedKey) {\n        return this;\n      }\n\n      _Navigation.prototype.onItemMouseEnter.apply(this, arguments);\n\n      if (this.props.selectedStyle) {\n        this.setState({\n          focusedKey: itemid\n        });\n      }\n    }\n  };\n\n  Vertical.prototype.onItemMouseLeave = function onItemMouseLeave() {\n    var trigger = this.context.trigger;\n    trigger = trigger || this.props.trigger;\n\n    if (trigger === 'hover') {\n      _Navigation.prototype.onItemMouseLeave.apply(this, arguments);\n\n      if (this.props.selectedStyle) {\n        this.setState({\n          focusedKey: null\n        });\n      }\n    }\n  };\n\n  Vertical.prototype.onItemClick = function onItemClick(itemid, item) {\n    var focused = item.props.focused;\n    var trigger = this.context.trigger;\n    trigger = trigger || this.props.trigger;\n\n    if (trigger === 'hover') {\n      if (itemid === Vertical.navigationMoreKey) {\n        return this;\n      }\n    }\n\n    if (focused) {\n      if (itemid === Vertical.navigationMoreKey) {\n        return this;\n      }\n    }\n\n    if (trigger === 'click') {\n      if (itemid === this.state.focusedKey) {\n        if (focused) {\n          this.setState({\n            focusedKey: null\n          });\n        }\n      } else {\n        this.setState({\n          focusedKey: itemid\n        });\n      }\n    }\n\n    _Navigation.prototype.onItemClick.apply(this, arguments);\n  };\n\n  Vertical.prototype.onItemSelect = function onItemSelect(itemid) {\n    if (itemid === Vertical.navigationMoreKey) {\n      return this;\n    }\n\n    if (itemid === this.state.selectedKey) {\n      return this;\n    }\n\n    _Navigation.prototype.onItemSelect.apply(this, arguments);\n\n    if (this.props.selectedStyle) {\n      this.setState({\n        selectedKey: itemid\n      });\n    }\n  };\n  /**\n   * 克隆子组件函数;过滤掉undefined，null情况\n   * @method cloneChildElement\n   * @return {Array}\n   */\n\n\n  Vertical.prototype.cloneChildElement = function cloneChildElement() {\n    var _this2 = this;\n\n    var _props = this.props,\n        morePositionKey = _props.morePositionKey,\n        moreText = _props.moreText;\n\n    var element = _Navigation.prototype.cloneChildElement.call(this);\n\n    var moreMenus = [];\n    var menus = [];\n    var isMore = false;\n    var refs = menus;\n\n    if (morePositionKey) {\n      _react2['default'].Children.forEach(element, function (child, index) {\n        var key = void 0;\n\n        if (child === undefined || child === null) {\n          return child;\n        }\n\n        key = child.props.itemid || child.key || index;\n\n        if (!isMore) {\n          if (key === morePositionKey) {\n            isMore = true;\n            refs = moreMenus;\n          }\n        }\n\n        refs.push(child);\n      });\n\n      if (moreMenus.length > 0) {\n        var moreKey = Vertical.navigationMoreKey;\n\n        var moreChild = _react2['default'].createElement(_item2['default'], {\n          text: moreText,\n          key: moreKey,\n          itemid: moreKey\n        }, _react2['default'].createElement(_nextMenu2['default'], null, moreMenus.map(function (child) {\n          var key = child.props.itemid || child.key;\n          var children = void 0;\n\n          if (child === null || child === undefined) {\n            return child;\n          }\n\n          if (child && child.props) {\n            if (child.props.link) {\n              children = _react2['default'].createElement('a', {\n                href: child.props.link,\n                target: child.props.target\n              }, child.props.text);\n            } else {\n              children = child.props.text;\n            }\n          }\n\n          return _react2['default'].createElement(_nextMenu2['default'].Item, {\n            key: key,\n            onClick: function onClick() {\n              _this2.onItemClick(key, child);\n\n              _this2.onItemSelect(key, child);\n            }\n          }, children);\n        })));\n\n        menus.push(_react2['default'].cloneElement(moreChild, this.cloneChildProperty(moreChild, moreKey)));\n      }\n\n      return menus;\n    }\n\n    return element;\n  };\n\n  Vertical.prototype.cloneChildProperty = function cloneChildProperty(child, key) {\n    var props = _Navigation.prototype.cloneChildProperty.call(this, child, key),\n        context = this.context,\n        navigation = context.rootNavigation || this,\n        isMount = this.isMount,\n        state = void 0;\n\n    state = navigation.getRootState ? navigation.getRootState() : this.state;\n\n    if (!isMount) {\n      if (child.props.focused) {\n        state.focusedKey = key;\n      }\n    }\n\n    props.focused = !isMount ? child.props.focused : key === state.focusedKey;\n    return props;\n  };\n\n  return Vertical;\n}(_navigation2['default']), _class.navigationMoreKey = 'navigation.item.more.' + +new Date(), _temp);\nexports['default'] = Vertical;\nmodule.exports = exports['default'];","map":null,"metadata":{},"sourceType":"script"}