{"ast":null,"code":"'use strict';\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _class, _temp;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _nextButton = require('../../next-button/lib/index.js');\n\nvar _nextButton2 = _interopRequireDefault(_nextButton);\n\nvar _nextFeedback = require('../../next-feedback/lib/index.js');\n\nvar _nextFeedback2 = _interopRequireDefault(_nextFeedback);\n\nvar _nextLocaleProvider = require('../../next-locale-provider/lib/index.js');\n\nvar _nextLocaleProvider2 = _interopRequireDefault(_nextLocaleProvider);\n\nvar _base = require('./base.js');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _content = require('./content.js');\n\nvar _index = require('./locale/index.js');\n\nvar _index2 = _interopRequireDefault(_index);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass);\n}\n\nvar noop = function noop() {};\n\nvar wrapper = function wrapper(fn, callback) {\n  return function () {\n    var res = void 0;\n\n    if (typeof fn === 'function') {\n      res = fn();\n    }\n\n    if (res && res.then) {\n      res.then(function (result) {\n        if (result !== false) {\n          callback();\n        }\n      });\n    } else if (res !== false) {\n      callback();\n    }\n  };\n},\n    feedbackMaps = {\n  alert: 'prompt',\n  confirm: 'help'\n};\n\nvar Modal = (_temp = _class = function (_React$Component) {\n  _inherits(Modal, _React$Component);\n\n  function Modal(props) {\n    _classCallCheck(this, Modal);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _this.state = {\n      visible: false\n    };\n    _this.close = _this.close.bind(_this);\n    return _this;\n  }\n  /* eslint-disable react/no-did-mount-set-state */\n  // preact compat\n  // see https://github.com/developit/preact/issues/556\n  // 我们通过触发componentWillReceiveProps绕过这个问题\n\n\n  Modal.prototype.componentDidMount = function componentDidMount() {\n    this.setState({\n      visible: true\n    });\n  };\n\n  Modal.prototype.render = function render() {\n    /* eslint-disable react/prop-types */\n    var _props = this.props,\n        prefix = _props.prefix,\n        onOk = _props.onOk,\n        onCancel = _props.onCancel,\n        afterClose = _props.afterClose,\n        className = _props.className,\n        title = _props.title,\n        type = _props.type,\n        content = _props.content,\n        locale = _props.locale,\n        onClose = _props.onClose,\n        needWrapper = _props.needWrapper,\n        footer = _props.footer,\n        others = _objectWithoutProperties(_props, ['prefix', 'onOk', 'onCancel', 'afterClose', 'className', 'title', 'type', 'content', 'locale', 'onClose', 'needWrapper', 'footer']);\n\n    locale = locale || {\n      ok: 'Ok',\n      cancel: 'Cancel'\n    };\n    var Ok = wrapper(onOk, this.close),\n        Cancel = wrapper(onCancel, this.close),\n        Close = wrapper(onClose, this.close);\n    return _react2['default'].createElement(_base2['default'], _extends({\n      prefix: prefix,\n      onClose: Close,\n      visible: this.state.visible,\n      className: className,\n      afterClose: afterClose,\n      role: 'alertdialog'\n    }, others), _react2['default'].createElement(_content.Header, {\n      prefix: prefix\n    }, title), _react2['default'].createElement(_content.Body, {\n      prefix: prefix\n    }, _react2['default'].createElement('div', {\n      className: prefix + 'dialog-' + type\n    }, needWrapper ? _react2['default'].createElement(_nextFeedback2['default'], {\n      prefix: prefix,\n      type: feedbackMaps[type],\n      size: 'large',\n      shape: 'addon',\n      title: content\n    }) : content)), _react2['default'].createElement(_content.Footer, {\n      prefix: prefix\n    }, footer ? footer : [_react2['default'].createElement(_nextButton2['default'], {\n      prefix: prefix,\n      type: 'primary',\n      onClick: this.state.visible ? Ok : noop,\n      key: 'ok'\n    }, locale.ok), type === 'confirm' ? _react2['default'].createElement(_nextButton2['default'], {\n      prefix: prefix,\n      type: 'normal',\n      onClick: this.state.visible ? Cancel : noop,\n      key: 'cancel'\n    }, locale.cancel) : null]));\n  };\n\n  Modal.prototype.close = function close() {\n    if (this.state.visible) {\n      this.setState({\n        visible: false\n      });\n    }\n  };\n\n  return Modal;\n}(_react2['default'].Component), _class.propTypes = {\n  needWrapper: _propTypes2['default'].bool,\n  prefix: _propTypes2['default'].string\n}, _class.defaultProps = {\n  needWrapper: true,\n  prefix: 'next-'\n}, _temp);\nModal.displayName = 'Modal';\nvar LocaleModal = (0, _nextLocaleProvider2['default'])(Modal);\nLocaleModal.LOCALE = _index2['default'];\n\nvar render = function render(config) {\n  var container = document.createElement('div');\n\n  var unMount = function unMount() {\n    if (config && config.afterClose && typeof config.afterClose === 'function') {\n      config.afterClose();\n    }\n\n    _reactDom2['default'].unmountComponentAtNode(container);\n\n    container.parentNode.removeChild(container);\n  };\n\n  var instance = void 0;\n  document.body.appendChild(container);\n\n  _reactDom2['default'].render(_react2['default'].createElement(LocaleModal, _extends({}, config, {\n    afterClose: unMount\n  })), container, function () {\n    instance = this;\n  });\n\n  return {\n    hide: function hide() {\n      var inc = instance && instance.getInstance();\n      inc && inc.close();\n    }\n  };\n};\n\nObject.keys(feedbackMaps).forEach(function (method) {\n  exports[method] = function (config) {\n    config = config || {};\n    config.type = method;\n    return render(config);\n  };\n});","map":null,"metadata":{},"sourceType":"script"}