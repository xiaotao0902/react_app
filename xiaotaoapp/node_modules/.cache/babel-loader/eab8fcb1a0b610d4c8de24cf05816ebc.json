{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _class, _temp;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _nextIcon = require('../../next-icon/lib/index.js');\n\nvar _nextIcon2 = _interopRequireDefault(_nextIcon);\n\nvar _nextUtil = require('../../next-util/lib/index.js');\n\nvar _nextDom = require('../../next-dom/lib/index.js');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _nextLocaleProvider = require('../../next-locale-provider/lib/index.js');\n\nvar _nextLocaleProvider2 = _interopRequireDefault(_nextLocaleProvider);\n\nvar _locale = require('./locale/index.js');\n\nvar _locale2 = _interopRequireDefault(_locale);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass);\n}\n/** Card */\n\n\nvar Card = (_temp = _class = function (_React$Component) {\n  _inherits(Card, _React$Component);\n\n  function Card(props, context) {\n    _classCallCheck(this, Card);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props, context));\n\n    _this.handleWindowResize = function () {\n      if (_this.state.expand) {\n        _this.cardBody.style.height = 'auto';\n      }\n    };\n\n    _this.handleToggle = function () {\n      _this.setState(function (prevState) {\n        return {\n          expand: !prevState.expand\n        };\n      });\n    };\n\n    _this._cardBodyRefHandler = function (ref) {\n      _this.cardBody = ref;\n    };\n\n    _this._contentRefHandler = function (ref) {\n      _this.content = ref;\n    };\n\n    _this._expandBtnRefHandler = function (ref) {\n      _this.expandBtn = ref;\n    };\n\n    _this.state = {\n      needMore: false,\n      expand: false,\n      contentHeight: 'auto'\n    };\n    return _this;\n  }\n\n  Card.prototype.componentDidMount = function componentDidMount() {\n    this._setNeedMore();\n\n    this._setBodyHeight();\n\n    _nextDom.events.on(window, 'resize', this.handleWindowResize);\n  };\n\n  Card.prototype.componentDidUpdate = function componentDidUpdate() {\n    this._setBodyHeight();\n  };\n\n  Card.prototype.componentWillUnmount = function componentWillUnmount() {\n    _nextDom.events.off(window, 'resize', this.handleWindowResize);\n  }; // 监听 window resize, 如果 state 是 expand 则设置 bodyHeight 为 auto 使得内容高度能够自适应拉伸\n  // 是否展示 More 按钮\n\n\n  Card.prototype._setNeedMore = function _setNeedMore() {\n    var bodyHeight = this.props.bodyHeight;\n\n    var contentHeight = this._getHeight(this.content);\n\n    this.setState({\n      needMore: bodyHeight !== 'auto' && contentHeight > bodyHeight\n    });\n  }; // 设置 Body 的高度\n\n\n  Card.prototype._setBodyHeight = function _setBodyHeight() {\n    var contentHeight = this._getHeight(this.content);\n\n    var expandBtnHeight = this._getHeight(this.expandBtn);\n\n    var expandBtnPaddingTop = this._getPaddingTop(this.expandBtn);\n\n    if (this.state.expand) {\n      // MEMO: 为什么不直接设置高度为 auto ? 答案是为了能够有展开动效\n      this.cardBody.style.height = contentHeight + expandBtnHeight + expandBtnPaddingTop + 'px';\n    } else {\n      this.cardBody.style.height = this.props.bodyHeight + 'px';\n    }\n  };\n\n  Card.prototype._getHeight = function _getHeight(node) {\n    if (node) {\n      return node.offsetHeight;\n    }\n\n    return 0;\n  };\n\n  Card.prototype._getPaddingTop = function _getPaddingTop(node) {\n    if (node && window && window.getComputedStyle) {\n      return parseFloat(window.getComputedStyle(node).paddingTop);\n    }\n\n    return 0;\n  };\n\n  Card.prototype.render = function render() {\n    var _classNames, _classNames2, _classNames3;\n\n    var _props = this.props,\n        className = _props.className,\n        title = _props.title,\n        subTitle = _props.subTitle,\n        extra = _props.extra,\n        titlePrefixLine = _props.titlePrefixLine,\n        titleBottomLine = _props.titleBottomLine,\n        children = _props.children,\n        locale = _props.locale,\n        others = _objectWithoutProperties(_props, ['className', 'title', 'subTitle', 'extra', 'titlePrefixLine', 'titleBottomLine', 'children', 'locale']);\n\n    var prefix = this.context.prefix || this.props.prefix;\n    var _state = this.state,\n        needMore = _state.needMore,\n        expand = _state.expand;\n    var cardCls = (0, _classnames2['default'])((_classNames = {}, _defineProperty(_classNames, prefix + 'card', true), _defineProperty(_classNames, className, className), _classNames));\n    var headCls = (0, _classnames2['default'])((_classNames2 = {}, _defineProperty(_classNames2, prefix + 'card-head', true), _defineProperty(_classNames2, prefix + 'card-head-prefix', titlePrefixLine), _classNames2));\n    var bodyCls = (0, _classnames2['default'])((_classNames3 = {}, _defineProperty(_classNames3, prefix + 'card-body', true), _defineProperty(_classNames3, prefix + 'card-body-no-title', !title), _defineProperty(_classNames3, prefix + 'card-body-need-more', needMore), _defineProperty(_classNames3, 'expand', expand), _classNames3));\n    return _react2['default'].createElement('div', _extends({}, (0, _nextUtil.pickAttrs)(others), {\n      className: cardCls\n    }), title ? _react2['default'].createElement('div', {\n      className: headCls\n    }, _react2['default'].createElement('div', {\n      className: prefix + 'card-head-main'\n    }, _react2['default'].createElement('span', {\n      className: prefix + 'card-title'\n    }, title), subTitle ? _react2['default'].createElement('span', {\n      className: prefix + 'card-sub-title'\n    }, subTitle) : null, extra ? _react2['default'].createElement('span', {\n      className: prefix + 'card-extra'\n    }, extra) : null), titleBottomLine ? _react2['default'].createElement('div', {\n      className: prefix + 'card-head-divider'\n    }) : null) : null, _react2['default'].createElement('div', {\n      className: bodyCls,\n      ref: this._cardBodyRefHandler\n    }, _react2['default'].createElement('div', {\n      className: prefix + 'card-content',\n      ref: this._contentRefHandler\n    }, children), needMore ? _react2['default'].createElement('div', {\n      className: prefix + 'card-more-btn',\n      ref: this._expandBtnRefHandler,\n      onClick: this.handleToggle\n    }, _react2['default'].createElement('span', null, expand ? locale.lessBtn : locale.moreBtn, ' ', _react2['default'].createElement(_nextIcon2['default'], {\n      type: 'arrow-down',\n      size: 'xs',\n      className: expand ? 'expand' : ''\n    }))) : null));\n  };\n\n  return Card;\n}(_react2['default'].Component), _class.propTypes = {\n  /**\n   * 样式的品牌前缀\n   */\n  prefix: _propTypes2['default'].string,\n\n  /**\n   * 卡片的标题\n   */\n  title: _propTypes2['default'].node,\n\n  /**\n   * 卡片的副标题\n   */\n  subTitle: _propTypes2['default'].node,\n\n  /**\n   * 是否显示标题的前缀线\n   */\n  titlePrefixLine: _propTypes2['default'].bool,\n\n  /**\n   * 是否显示标题栏的下划线\n   */\n  titleBottomLine: _propTypes2['default'].bool,\n  // TODO: 1.x change to `divider`\n\n  /**\n   * 内容区域的固定高度\n   */\n  bodyHeight: _propTypes2['default'].oneOfType([_propTypes2['default'].string, _propTypes2['default'].number]),\n\n  /**\n   * 标题区域的用户自定义内容\n   */\n  extra: _propTypes2['default'].node,\n\n  /**\n   * 自定义样式\n   */\n  className: _propTypes2['default'].string\n}, _class.defaultProps = {\n  prefix: 'next-',\n  titlePrefixLine: true,\n  titleBottomLine: true,\n  bodyHeight: 120\n}, _class.contextTypes = {\n  prefix: _propTypes2['default'].string\n}, _temp);\nCard.displayName = 'Card';\nvar CardLocale = (0, _nextLocaleProvider2['default'])(Card);\nCardLocale.LOCALE = _locale2['default'];\nexports['default'] = CardLocale;\nmodule.exports = exports['default'];","map":null,"metadata":{},"sourceType":"script"}