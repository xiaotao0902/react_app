{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.browser = browser;\nexports.getOffset = getOffset;\nexports.loopAllChildren = loopAllChildren;\nexports.isInclude = isInclude;\nexports.filterParentPosition = filterParentPosition;\nexports.handleCheckState = handleCheckState;\nexports.getCheck = getCheck;\nexports.getStrictlyValue = getStrictlyValue;\nexports.arraysEqual = arraysEqual;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction browser(navigator) {\n  var tem = void 0;\n  var ua = navigator.userAgent;\n  var M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n\n  if (/trident/i.test(M[1])) {\n    tem = /\\brv[ :]+(\\d+)/g.exec(ua) || []; // eslint-disable-next-line\n\n    return 'IE ' + (tem[1] || '');\n  }\n\n  if (M[1] === 'Chrome') {\n    tem = ua.match(/\\b(OPR|Edge)\\/(\\d+)/);\n\n    if (tem) {\n      return tem.slice(1).join(' ').replace('OPR', 'Opera');\n    }\n  }\n\n  M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];\n  tem = ua.match(/version\\/(\\d+)/i);\n\n  if (tem) {\n    M.splice(1, 1, tem[1]);\n  }\n\n  return M.join(' ');\n}\n\nfunction getOffset(elem) {\n  var rect = elem.getBoundingClientRect();\n  var win = elem.ownerDocument.defaultView;\n  return {\n    top: rect.top + win.pageYOffset,\n    left: rect.left + win.pageXOffset\n  };\n}\n\nfunction getChildrenlength(children) {\n  var len = 1;\n\n  if (Array.isArray(children)) {\n    len = children.length;\n  }\n\n  return len;\n}\n\nfunction getSiblingPosition(index, len, siblingPosition) {\n  if (len === 1) {\n    siblingPosition.first = true;\n    siblingPosition.last = true;\n  } else {\n    siblingPosition.first = index === 0;\n    siblingPosition.last = index === len - 1;\n  }\n\n  return siblingPosition;\n}\n\nfunction loopAllChildren(childs, callback, parent) {\n  var loop = function loop(children, level, _parent) {\n    var len = getChildrenlength(children);\n\n    _react2['default'].Children.forEach(children, function (item, index) {\n      var pos = level + '-' + index;\n\n      if (item.props && item.props.children && item.type && typeof item.type === 'function' && item.type.isTreeNode) {\n        loop(item.props.children, pos, {\n          node: item,\n          pos: pos\n        });\n      }\n\n      callback(item, index, pos, item.key || pos, getSiblingPosition(index, len, {}), _parent);\n    });\n  };\n\n  loop(childs, 0, parent);\n}\n\nfunction isInclude(smallArray, bigArray) {\n  return smallArray.every(function (ii, i) {\n    return ii === bigArray[i];\n  });\n}\n\nfunction filterParentPosition(arr) {\n  var levelObj = {};\n  arr.forEach(function (item) {\n    var posLen = item.split('-').length;\n\n    if (!levelObj[posLen]) {\n      levelObj[posLen] = [];\n    }\n\n    levelObj[posLen].push(item);\n  });\n  var levelArr = Object.keys(levelObj).sort(function (a, b) {\n    return Number(a) - Number(b);\n  });\n\n  var _loop = function _loop(i) {\n    if (levelArr[i + 1]) {\n      levelObj[levelArr[i]].forEach(function (ii) {\n        var _loop2 = function _loop2(j) {\n          levelObj[levelArr[j]].forEach(function (_i, index) {\n            if (isInclude(ii.split('-'), _i.split('-'))) {\n              levelObj[levelArr[j]][index] = null;\n            }\n          });\n          levelObj[levelArr[j]] = levelObj[levelArr[j]].filter(function (p) {\n            return p;\n          });\n        };\n\n        for (var j = i + 1; j < levelArr.length; j++) {\n          _loop2(j);\n        }\n      });\n    }\n  };\n\n  for (var i = 0; i < levelArr.length; i++) {\n    _loop(i);\n  }\n\n  var nArr = [];\n  levelArr.forEach(function (i) {\n    nArr = nArr.concat(levelObj[i]);\n  });\n  return nArr;\n}\n\nfunction stripTail(str) {\n  var arr = str.match(/(.+)(-[^-]+)$/);\n  var st = '';\n\n  if (arr && arr.length === 3) {\n    st = arr[1];\n  }\n\n  return st;\n}\n\nfunction splitPosition(pos) {\n  return pos.split('-');\n}\n\nfunction handleCheckState(obj, checkedPositionArr, checkIt) {\n  var objKeys = Object.keys(obj);\n  objKeys.forEach(function (i, index) {\n    var iArr = splitPosition(i);\n    var saved = false;\n    checkedPositionArr.forEach(function (_pos) {\n      var _posArr = splitPosition(_pos);\n\n      if (iArr.length > _posArr.length && isInclude(_posArr, iArr)) {\n        obj[i].halfChecked = false;\n        obj[i].checked = checkIt;\n        objKeys[index] = null;\n      }\n\n      if (iArr[0] === _posArr[0] && iArr[1] === _posArr[1]) {\n        saved = true;\n      }\n    });\n\n    if (!saved) {\n      objKeys[index] = null;\n    }\n  });\n  objKeys = objKeys.filter(function (i) {\n    return i;\n  });\n\n  var _loop3 = function _loop3(_pIndex) {\n    var loop = function loop(__pos) {\n      var _posLen = splitPosition(__pos).length;\n\n      if (_posLen <= 2) {\n        return;\n      }\n\n      var sibling = 0;\n      var siblingChecked = 0;\n      var parentPosition = stripTail(__pos);\n      objKeys.forEach(function (i) {\n        var iArr = splitPosition(i);\n\n        if (iArr.length === _posLen && isInclude(splitPosition(parentPosition), iArr)) {\n          sibling++;\n\n          if (obj[i].checked) {\n            siblingChecked++;\n\n            var _i = checkedPositionArr.indexOf(i);\n\n            if (_i > -1) {\n              checkedPositionArr.splice(_i, 1);\n\n              if (_i <= _pIndex) {\n                _pIndex--;\n              }\n            }\n          } else if (obj[i].halfChecked) {\n            siblingChecked += 0.5;\n          }\n        }\n      });\n      var parent = obj[parentPosition];\n\n      if (siblingChecked === 0) {\n        parent.checked = false;\n        parent.halfChecked = false;\n      } else if (siblingChecked === sibling) {\n        parent.checked = true;\n        parent.halfChecked = false;\n      } else {\n        parent.halfChecked = true;\n        parent.checked = false;\n      }\n\n      loop(parentPosition);\n    };\n\n    loop(checkedPositionArr[_pIndex], _pIndex);\n    pIndex = _pIndex;\n  };\n\n  for (var pIndex = 0; pIndex < checkedPositionArr.length; pIndex++) {\n    _loop3(pIndex);\n  }\n}\n\nfunction getCheck(treeNodesStates) {\n  var halfCheckedKeys = [];\n  var checkedKeys = [];\n  var checkedNodes = [];\n  var checkedNodesPositions = [];\n  Object.keys(treeNodesStates).forEach(function (item) {\n    var itemObj = treeNodesStates[item];\n\n    if (itemObj.checked) {\n      checkedKeys.push(itemObj.key);\n      checkedNodes.push(itemObj.node);\n      checkedNodesPositions.push({\n        node: itemObj.node,\n        pos: item\n      });\n    } else if (itemObj.halfChecked) {\n      halfCheckedKeys.push(itemObj.key);\n    }\n  });\n  return {\n    halfCheckedKeys: halfCheckedKeys,\n    checkedKeys: checkedKeys,\n    checkedNodes: checkedNodes,\n    checkedNodesPositions: checkedNodesPositions,\n    treeNodesStates: treeNodesStates\n  };\n}\n\nfunction getStrictlyValue(checkedKeys, halfChecked) {\n  if (halfChecked) {\n    return {\n      checked: checkedKeys,\n      halfChecked: halfChecked\n    };\n  }\n\n  return checkedKeys;\n}\n\nfunction arraysEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === null || typeof a === 'undefined' || b === null || typeof b === 'undefined') {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (var i = 0; i < a.length; ++i) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}","map":null,"metadata":{},"sourceType":"script"}